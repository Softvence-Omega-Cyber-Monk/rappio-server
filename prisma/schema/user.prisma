// Reuse the same enum
enum UserStatus {
  ACTIVE
  INACTIVE
  SUSPEND
}

enum UserRole {
  ADMIN
  USER
}

model User {
  id                   String     @id @default(uuid())
  email                String     @unique
  password             String
  firstName            String
  lastName             String?
  phone                String?
  profileImage         String?
  role                 UserRole   @default(USER)
  status               UserStatus @default(ACTIVE)
  lastLogin            DateTime?
  subscription_status  String?
  verified             Boolean    @default(false)
  // --- Fields for RESET (TOTP) ---
  passwordResetToken   String? // store token code
  passwordResetExpires DateTime? // code live time
  // --- Fields for 2FA (TOTP) ---
  is2FAEnabled         Boolean    @default(false)
  twoFactorSecret      String? // The secret key used by the Authenticator app
  //twoFactorRecoveryCodes String[] // Store encrypted one-time backup codes

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("users")
}
